<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>

    <script src="../../lib/jquery.1.9.1.min.js"></script>
    <script src="./js/jquery-ui-1.9.2.min.js"></script>

    <link rel="stylesheet" href="./style/pqgrid.min.css">

    <script src="../../public/etGrid.min.js"></script>
</head>
<body>
    <div id="grid"></div>
    <script>
        var data = [[1, 'Exxon Mobil', 'Ex', '339,938.0', '36,130.0', '23,333.0'],
        [2, 'Wal-Mart Stores', 'WS', '315,654.0', '11,231.0', '24,342.0'],
        [3, 'Royal Dutch Shell', 'RDS', '306,731.0', '25,311.0', '56,231.2'],
        [4, 'BP', 'B', '267,600.0', '22,341.0', '71,923.4'],
        [5, 'General Motors', 'GM', '192,604.0', '-10,567.0', '52,934.0'],
        [6, 'Chevron', 'C', '189,481.0', '14,099.0', '12,023.5'],
        [7, 'DaimlerChrysler', 'DC', '186,106.3', '3,536.3', '42,734.0'],
        [8, 'Toyota Motor', 'TM', '185,805.0', '12,119.6', '57,023.4'],
        [9, 'Ford Motor', 'FM', '177,210.0', '2,024.0', '22,896.0'],
        [10, 'ConocoPhillips', 'CP', '166,683.0', '13,529.0', '72,456.0'],
        [11, 'General Electric', 'GE', '157,153.0', '16,353.0', '16,912.5'],
        [12, 'Total', 'T', '152,360.7', '15,250.0', '74,236.5'],
        [13, 'ING Group', 'IG', '138,235.3', '8,958.9', '52,012.9'],
        [14, 'Citigroup', 'CG', '131,045.0', '24,589.0', '90,342.0'],
        [15, 'AXA', 'A', '129,839.2', '5,186.5', '13,043.8'],
        [16, 'Allianz', 'AZ', '121,406.0', '5,442.4', '19,529.5'],
        [17, 'Volkswagen', 'VW', '118,376.6', '1,391.7', '84,472.7'],
        [18, 'Fortis', 'F', '112,351.4', '4,896.3', '83,473.0'],
        [19, 'Cr√©dit Agricole', 'CA', '110,764.6', '7,434.3', '14,567.4'],
        [20, 'American Intl. Group', 'AIG', '108,905.0', '10,477.0', '10,533.0']];

    for (var i = 0; i < data.length; i++) {
        //rev(total)
        var revDom = parseFloat(data[i][3].replace(",", ""));
        var revExp = parseFloat(data[i][4].replace(",", ""));
        var expenditure = parseFloat(data[i][5].replace(",", ""));
        data[i][6] = revTotal = revDom + revExp;
        //profits
        data[i][7] = revTotal - expenditure;
    }
    //calculate Rank based on profits
    data = data.sort(function (obj1, obj2) {
        var val1 = obj1[7];
        var val2 = obj2[7];
        val1 = val1 ? parseInt(val1) : 0;
        val2 = val2 ? parseInt(val2) : 0;

        return (val2 - val1);
    });
    for (var i = 0; i < data.length; i++) {
        var rdata = data[i];
        //Rank
        rdata[8] = (i + 1);
        rdata[9] = Math.random();
        rdata[10] = Math.random();
        rdata[11] = Math.random();
        rdata[12] = Math.random();
        rdata[13] = Math.random();
        rdata[14] = Math.random();
        rdata[15] = Math.random();
        rdata[16] = Math.random();
    }

    var obj = { width: 750,
        height: 430,            
        showTop:false,
        title: "Grid with header grouping",
        showBottom: false,
        hoverMode: 'cell',
        selectionModel: { type: 'cell' },  
        checkbox: true,          
        freezeCols: 1,
        minWidth: 90,            
        numberCell: { show: true },
        editable: true,
        resizable: true
    };
    obj.columnTemplate = {width:100, align:'right'};
    obj.columns = [{ display: "Some No", hidden:true},
        { display: "Company", width: 140, align: "center", columns: [{ display: "Company A" }, { display: "Company B"}] },
        { display: "Balance Sheet", align: "center", columns: [
            { display: "Revenues ($ millions)", dataType: "float", align: "center", columns: [
                { display: "Domestic", name: 3, align: "right", dataType: "float" },
                { display: "Exports", name: 4, align: 'right', dataType: "float" },
                { display: "Total", width: 120, editable: false, name: 6, align: "right", dataType: "float", render: function (ui) {
                    return $.paramquery.formatCurrency(ui.rowData[ui.dataIndx]);
                }
                }
            ]
            },
            { display: "Expenditure <br /> ($ millions)", dataType: "float", align: "right", name: 5 },
            { display: "Profits ($ millions)<br/>Revenues - Expenditure", width: 140, dataType: "float", align: "right", editable: false, name: 7, 
                render: function (ui) {
                    return $.paramquery.formatCurrency(ui.rowData[ui.dataIndx]);
                }
            }
            ]
        },
    //{ display: "Rank", editable: false, width: 140, align: 'center', name: 7}];
    {display: "Rank", align: 'center', columns: [{ name: 8, display: "Rank1" }, { display: "Rank2", columns:
        [{ display: "Rank21" }, { display: "Rank 22", columns: [{ display: "Rank 221" }, { display: "Rank 222", columns: [{ display: "Rank 2221" }, { display: "Rank 2222" }, { display: "Rank 2223"}]}]
        }, { display: "Rank 3"}]
    }
    ]
}, { display: "Column", align: "center", columns: [{ display: "Column1" }, { display: "Column2"}]}];

obj.dataModel = {
    data: data,
    location: "local",
    // sortIndx: 1
};
var $grid = $("#grid").etGrid(obj);
    </script>
</body>
</html>